/**
* File awcs-wc-add-to-cart-variation.min.js
* Slightly modified version of wc_add_to_cart_variation script
*/
(function(g,r,C,p){var k=function(a){var b=this;b.$form=a;b.$attributeFields=a.find(".variations select");b.$singleVariation=a.find(".single_variation");b.$singleVariationWrap=a.find(".single_variation_wrap");b.$resetVariations=a.find(".reset_variations");b.$product=a.closest(".product");b.variationData=a.data("product_variations");b.useAjax=!1===b.variationData;b.xhr=!1;b.loading=!0;b.$singleVariationWrap.show();b.$form.off(".wc-variation-form");b.getChosenAttributes=b.getChosenAttributes.bind(b);
b.findMatchingVariations=b.findMatchingVariations.bind(b);b.isMatch=b.isMatch.bind(b);b.toggleResetLink=b.toggleResetLink.bind(b);a.on("click.wc-variation-form",".reset_variations",{variationForm:b},b.onReset);a.on("reload_product_variations",{variationForm:b},b.onReload);a.on("hide_variation",{variationForm:b},b.onHide);a.on("show_variation",{variationForm:b},b.onShow);a.on("reset_data",{variationForm:b},b.onResetDisplayedVariation);a.on("reset_image",{variationForm:b},b.onResetImage);a.on("change.wc-variation-form",
".variations select",{variationForm:b},b.onChange);a.on("found_variation.wc-variation-form",{variationForm:b},b.onFoundVariation);a.on("check_variations.wc-variation-form",{variationForm:b},b.onFindVariation);a.on("update_variation_values.wc-variation-form",{variationForm:b},b.onUpdateAttributes);setTimeout(function(){a.trigger("check_variations");a.trigger("wc_variation_form",b);b.loading=!1},100)};k.prototype.onReset=function(a){a.preventDefault();a.data.variationForm.$attributeFields.val("").change();
a.data.variationForm.$form.trigger("reset_data")};k.prototype.onReload=function(a){a=a.data.variationForm;a.variationData=a.$form.data("product_variations");a.useAjax=!1===a.variationData;a.$form.trigger("check_variations")};k.prototype.onHide=function(a){a.preventDefault();a.data.variationForm.$form.find(".single_add_to_cart_button, .awcs_loop_variation_add_to_cart_button").removeClass("wc-variation-is-unavailable").addClass("disabled wc-variation-selection-needed");a.data.variationForm.$form.find(".woocommerce-variation-add-to-cart").removeClass("woocommerce-variation-add-to-cart-enabled").addClass("woocommerce-variation-add-to-cart-disabled")};
k.prototype.onShow=function(a,b,c){a.preventDefault();c?(a.data.variationForm.$form.find(".single_add_to_cart_button, .awcs_loop_variation_add_to_cart_button").removeClass("disabled wc-variation-selection-needed wc-variation-is-unavailable"),a.data.variationForm.$form.find(".woocommerce-variation-add-to-cart").removeClass("woocommerce-variation-add-to-cart-disabled").addClass("woocommerce-variation-add-to-cart-enabled")):(a.data.variationForm.$form.find(".single_add_to_cart_button, .awcs_loop_variation_add_to_cart_button").removeClass("wc-variation-selection-needed").addClass("disabled wc-variation-is-unavailable"),
a.data.variationForm.$form.find(".woocommerce-variation-add-to-cart").removeClass("woocommerce-variation-add-to-cart-enabled").addClass("woocommerce-variation-add-to-cart-disabled"));wp.mediaelement&&a.data.variationForm.$form.find(".wp-audio-shortcode, .wp-video-shortcode").not(".mejs-container").filter(function(){return!g(this).parent().hasClass("mejs-mediaelement")}).mediaelementplayer(wp.mediaelement.settings)};k.prototype.onResetDisplayedVariation=function(a){a=a.data.variationForm;a.$product.find(".product_meta").find(".sku").wc_reset_content();
a.$product.find(".product_weight, .woocommerce-product-attributes-item--weight .woocommerce-product-attributes-item__value").wc_reset_content();a.$product.find(".product_dimensions, .woocommerce-product-attributes-item--dimensions .woocommerce-product-attributes-item__value").wc_reset_content();a.$form.trigger("reset_image");a.$singleVariation.slideUp(200).trigger("hide_variation")};k.prototype.onResetImage=function(a){a.data.variationForm.$form.wc_variations_image_update(!1)};k.prototype.onFindVariation=
function(a,b){var c=a.data.variationForm,d="undefined"!==typeof b?b:c.getChosenAttributes(),e=d.data;d.count&&d.count===d.chosenCount?c.useAjax?(c.xhr&&c.xhr.abort(),c.$form.block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),e.product_id=parseInt(c.$form.data("product_id"),10),e.custom_data=c.$form.data("custom_data"),c.xhr=g.ajax({url:awcs_wc_add_to_cart_variation_params.wc_ajax_url.toString().replace("%%endpoint%%","get_variation"),type:"POST",data:e,success:function(f){f?c.$form.trigger("found_variation",
[f]):(c.$form.trigger("reset_data"),d.chosenCount=0,c.loading||(c.$form.find(".single_variation").after('<p class="wc-no-matching-variations woocommerce-info">'+awcs_wc_add_to_cart_variation_params.i18n_no_matching_variations_text+"</p>"),c.$form.find(".wc-no-matching-variations").slideDown(200)))},complete:function(){c.$form.unblock()}})):(c.$form.trigger("update_variation_values"),(e=c.findMatchingVariations(c.variationData,e).shift())?c.$form.trigger("found_variation",[e]):(c.$form.trigger("reset_data"),
d.chosenCount=0,c.loading||(c.$form.find(".single_variation").after('<p class="wc-no-matching-variations woocommerce-info">'+awcs_wc_add_to_cart_variation_params.i18n_no_matching_variations_text+"</p>"),c.$form.find(".wc-no-matching-variations").slideDown(200)))):(c.$form.trigger("update_variation_values"),c.$form.trigger("reset_data"));c.toggleResetLink(0<d.chosenCount)};k.prototype.onFoundVariation=function(a,b){var c=a.data.variationForm,d=c.$product.find(".product_meta").find(".sku"),e=c.$product.find(".product_weight, .woocommerce-product-attributes-item--weight .woocommerce-product-attributes-item__value"),
f=c.$product.find(".product_dimensions, .woocommerce-product-attributes-item--dimensions .woocommerce-product-attributes-item__value"),h=c.$singleVariationWrap.find(".quantity"),m=!0;b.sku?d.wc_set_content(b.sku):d.wc_reset_content();b.weight?e.wc_set_content(b.weight_html):e.wc_reset_content();b.dimensions?f.wc_set_content(g.parseHTML(b.dimensions_html)[0].data):f.wc_reset_content();c.$form.wc_variations_image_update(b);d=(b.variation_is_visible?D("variation-template"):D("unavailable-variation-template"))({variation:b});
d=d.replace("/*<![CDATA[*/","");d=d.replace("/*]]\x3e*/","");c.$singleVariation.html(d);c.$form.find('input[name="variation_id"], input.variation_id').val(b.variation_id).change();"yes"===b.is_sold_individually?(h.find("input.qty").val("1").attr("min","1").attr("max","").change(),h.hide()):(d=h.find("input.qty"),e=parseFloat(d.val()),isNaN(e)?e=b.min_qty:(e=e>parseFloat(b.max_qty)?b.max_qty:e,e=e<parseFloat(b.min_qty)?b.min_qty:e),d.attr("min",b.min_qty).attr("max",b.max_qty).val(e).change(),h.show());
b.is_purchasable&&b.is_in_stock&&b.variation_is_visible||(m=!1);g.trim(c.$singleVariation.text())?c.$singleVariation.slideDown(200).trigger("show_variation",[b,m]):c.$singleVariation.show().trigger("show_variation",[b,m])};k.prototype.onChange=function(a){a=a.data.variationForm;a.$form.find('input[name="variation_id"], input.variation_id').val("").change();a.$form.find(".wc-no-matching-variations").remove();a.useAjax||a.$form.trigger("woocommerce_variation_select_change");a.$form.trigger("check_variations");
a.$form.trigger("woocommerce_variation_has_changed")};k.prototype.addSlashes=function(a){a=a.replace(/'/g,"\\'");return a=a.replace(/"/g,'\\"')};k.prototype.onUpdateAttributes=function(a){var b=a.data.variationForm,c=b.getChosenAttributes().data;b.useAjax||(b.$attributeFields.each(function(d,e){var f=g(e),h=f.data("attribute_name")||f.attr("name"),m=g(e).data("show_option_none"),q=":gt(0)",l=0,n=g("<select/>"),t=f.val()||"",u=!0;f.data("attribute_html")||(l=f.clone(),l.find("option").removeAttr("disabled attached").removeAttr("selected"),
f.data("attribute_options",l.find("option"+q).get()),f.data("attribute_html",l.html()));n.html(f.data("attribute_html"));l=g.extend(!0,{},c);l[h]="";l=b.findMatchingVariations(b.variationData,l);for(var x in l)if("undefined"!==typeof l[x]){var y=l[x].attributes,v;for(v in y)if(y.hasOwnProperty(v)){var w=y[v],z="";if(v===h)if(l[x].variation_is_active&&(z="enabled"),w){w=g("<div/>").html(w).text();var A=n.find("option");if(A.length)for(var B=0,F=A.length;B<F;B++){var E=g(A[B]),G=E.val();if(w===G){E.addClass("attached "+
z);break}}}else n.find("option:gt(0)").addClass("attached "+z)}}l=n.find("option.attached").length;t&&(u=!1,0!==l&&n.find("option.attached.enabled").each(function(){var H=g(this).val();if(t===H)return u=!0,!1}));0<l&&t&&u&&"no"===m&&(n.find("option:first").remove(),q="");n.find("option"+q+":not(.attached)").remove();f.html(n.html());f.find("option"+q+":not(.enabled)").prop("disabled",!0);t?u?f.val(t):f.val("").change():f.val("")}),b.$form.trigger("woocommerce_update_variation_values"))};k.prototype.getChosenAttributes=
function(){var a={},b=0,c=0;this.$attributeFields.each(function(){var d=g(this).data("attribute_name")||g(this).attr("name"),e=g(this).val()||"";0<e.length&&c++;b++;a[d]=e});return{count:b,chosenCount:c,data:a}};k.prototype.findMatchingVariations=function(a,b){for(var c=[],d=0;d<a.length;d++){var e=a[d];this.isMatch(e.attributes,b)&&c.push(e)}return c};k.prototype.isMatch=function(a,b){var c=!0,d;for(d in a)if(a.hasOwnProperty(d)){var e=a[d],f=b[d];e!==p&&f!==p&&0!==e.length&&0!==f.length&&e!==f&&
(c=!1)}return c};k.prototype.toggleResetLink=function(a){a?"hidden"===this.$resetVariations.css("visibility")&&this.$resetVariations.css("visibility","visible").hide().fadeIn():this.$resetVariations.css("visibility","hidden")};g.fn.wc_variation_form=function(){new k(this);return this};g.fn.wc_set_content=function(a){p===this.attr("data-o_content")&&this.attr("data-o_content",this.text());this.text(a)};g.fn.wc_reset_content=function(){p!==this.attr("data-o_content")&&this.text(this.attr("data-o_content"))};
g.fn.wc_set_variation_attr=function(a,b){p===this.attr("data-o_"+a)&&this.attr("data-o_"+a,this.attr(a)?this.attr(a):"");!1===b?this.removeAttr(a):this.attr(a,b)};g.fn.wc_reset_variation_attr=function(a){p!==this.attr("data-o_"+a)&&this.attr(a,this.attr("data-o_"+a))};g.fn.wc_maybe_trigger_slide_position_reset=function(a){var b=g(this),c=b.closest(".product").find(".images"),d=!1;a=a&&a.image_id?a.image_id:"";b.attr("current-image")!==a&&(d=!0);b.attr("current-image",a);d&&c.trigger("woocommerce_gallery_reset_slide_position")};
g.fn.wc_variations_image_update=function(a){var b=this,c=b.closest(".product"),d=c.find(".images"),e=c.find(".flex-control-nav");c=e.find("li:eq(0) img");var f=d.find(".woocommerce-product-gallery__image, .woocommerce-product-gallery__image--placeholder").eq(0),h=f.find(".wp-post-image"),m=f.find("a").eq(0);if(a&&a.image&&a.image.src&&1<a.image.src.length){0<e.find('li img[data-o_src="'+a.image.gallery_thumbnail_src+'"]').length&&b.wc_variations_image_reset();e=e.find('li img[src="'+a.image.gallery_thumbnail_src+
'"]');if(0<e.length){e.trigger("click");b.attr("current-image",a.image_id);r.setTimeout(function(){g(r).trigger("resize");d.trigger("woocommerce_gallery_init_zoom")},20);return}h.wc_set_variation_attr("src",a.image.src);h.wc_set_variation_attr("height",a.image.src_h);h.wc_set_variation_attr("width",a.image.src_w);h.wc_set_variation_attr("srcset",a.image.srcset);h.wc_set_variation_attr("sizes",a.image.sizes);h.wc_set_variation_attr("title",a.image.title);h.wc_set_variation_attr("data-caption",a.image.caption);
h.wc_set_variation_attr("alt",a.image.alt);h.wc_set_variation_attr("data-src",a.image.full_src);h.wc_set_variation_attr("data-large_image",a.image.full_src);h.wc_set_variation_attr("data-large_image_width",a.image.full_src_w);h.wc_set_variation_attr("data-large_image_height",a.image.full_src_h);f.wc_set_variation_attr("data-thumb",a.image.src);c.wc_set_variation_attr("src",a.image.gallery_thumbnail_src);m.wc_set_variation_attr("href",a.image.full_src)}else b.wc_variations_image_reset();r.setTimeout(function(){g(r).trigger("resize");
b.wc_maybe_trigger_slide_position_reset(a);d.trigger("woocommerce_gallery_init_zoom")},20)};g.fn.wc_variations_image_reset=function(){var a=this.closest(".product"),b=a.find(".images");a=a.find(".flex-control-nav").find("li:eq(0) img");b=b.find(".woocommerce-product-gallery__image, .woocommerce-product-gallery__image--placeholder").eq(0);var c=b.find(".wp-post-image"),d=b.find("a").eq(0);c.wc_reset_variation_attr("src");c.wc_reset_variation_attr("width");c.wc_reset_variation_attr("height");c.wc_reset_variation_attr("srcset");
c.wc_reset_variation_attr("sizes");c.wc_reset_variation_attr("title");c.wc_reset_variation_attr("data-caption");c.wc_reset_variation_attr("alt");c.wc_reset_variation_attr("data-src");c.wc_reset_variation_attr("data-large_image");c.wc_reset_variation_attr("data-large_image_width");c.wc_reset_variation_attr("data-large_image_height");b.wc_reset_variation_attr("data-thumb");a.wc_reset_variation_attr("src");d.wc_reset_variation_attr("href")};g(function(){if("undefined"!==typeof awcs_wc_add_to_cart_variation_params)g(C).on("change",
".variations_form select",function(){g(this).closest("form.variations_form").wc_variation_form()})});var D=function(a){var b=C.getElementById("tmpl-"+a).textContent,c;return(c=(c=(c=/<#\s?data\./.test(b))||/{{{?\s?data\.(?!variation\.).+}}}?/.test(b))||/{{{?\s?data\.variation\.[\w-]*[^\s}]/.test(b))?wp.template(a):function(d){var e=d.variation||{};return b.replace(/({{{?)\s?data\.variation\.([\w-]*)\s?(}}}?)/g,function(f,h,m,q){if(h.length!==q.length)return"";f=e[m]||"";return 2===h.length?r.escape(f):
f})}}})(jQuery,window,document);